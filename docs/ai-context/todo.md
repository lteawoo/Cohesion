# 작업 목록 (To-Do)

## 초기 설정
- [x] AI 컨텍스트 파일 생성 (`status.md`, `todo.md`, `decision_log.md`)
- [ ] 백엔드 기본 서버 실행 및 헬스 체크 확인
- [ ] 프론트엔드 빌드 및 백엔드 임베딩 동작 확인

## 기능 구현 / 버그 수정
- [x] cross-space 이동/복사 destination Space 권한 검증 보완 (`handleFileMove`/`handleFileCopy`에 destination `write` 권한 체크 + 단위 테스트 추가) (#117)
- [x] 다운로드 티켓 경로 2차 적용 (단일 다운로드 `download-ticket` API + 단일/다중 네이티브 다운로드 통일)
- [x] 다중/ZIP 다운로드 티켓 기반 네이티브 경로 1차 도입 (`download-multiple-ticket` + `/api/downloads/{ticket}` + 프론트 다중 다운로드 네이티브 전환)
- [x] 데스크톱 다중선택 우클릭 카운트 표기 정렬 (항목별 `N개` 제거 + 메뉴 상단 `N개 선택됨` 요약 추가)
- [x] 다운로드 완료 토스트 제거 (`handleBulkDownload` 성공 토스트 제거, 실패 토스트 유지)
- [x] 다운로드 진행률 UI 제거 (`useFileOperations` 진행률 상태/계산 제거 + `FolderContent` 우측 하단 플로팅 카드 제거)
- [x] Status Hosts 주소 클릭 복사 지원 (`ServerStatus` Hosts 항목 버튼화 + 클립보드 복사/fallback + 성공/실패 토스트)
- [x] 다운로드 진행률 UI 적용 (스트림 기반 바이트/퍼센트 계산 + `FolderContent` 우측 하단 플로팅 카드 + 다운로드 응답 `Content-Length` 보강)
- [x] 탐색 오버레이 선택 정책 보강 (드롭다운/팝오버/셀렉트 오버레이 `user-select: none` + 경로바/다운로드 카드 우클릭 전파 차단)
- [x] 탐색 앱 쉘 우클릭 차단 적용 (MainLayout `onContextMenuCapture` + 입력 요소 예외 허용)
- [x] Google Drive 스타일 텍스트 선택 차단 적용 (MainLayout 탐색 앱 쉘 범위 `user-select: none` + 입력 요소 예외 처리)
- [x] 프로젝트 라이선스 `AGPL-3.0-only` 확정 및 루트 `LICENSE` 추가
- [x] README 2차 정리 (미지원 항목/프로젝트 구조/운영 메모 제거, 서비스 목표 문구 재정의, 라이선스 문구 간소화)
- [x] README를 현재 서비스 범위 기준으로 오픈소스 스타일 개편 (이모티콘 제거, Build 중심 재작성, 설정파일 예시 제거)
- [x] 파일 확장자별 아이콘 썸네일 1차 적용 (Grid/Table 파일 아이콘을 확장자 카테고리 기반으로 분기)
- [x] `http_enabled/httpEnabled` 설정 필드 제거 (백엔드 설정 모델/기본 YAML + 프론트 설정 타입/UI/스토어 정리)
- [x] 모노레포 전역 `config/secrets` Git ignore 보강 (`.gitignore`에 `**/config/secrets/` 추가)
- [x] 전체 보안점검 수행 (코드/설정/의존성 점검 및 취약점 우선순위 도출)
- [x] WebDAV 보안 하드닝 (Basic Auth 강제 + Space 권한 체크 + `webdav_enabled` 플래그 적용)
- [x] 기본 관리자 초기값 하드닝 (프로덕션 기본 계정/비밀번호 fallback 금지)
- [x] 초기 관리자 보안 부팅 전환 (기본 fallback 제거 + 최초 실행 setup API/화면 도입)
- [x] JWT/SQLite 로컬 비밀값 하드닝 (JWT 랜덤 시크릿 파일 생성, DB 파일 권한 제한)
- [x] 실행 문서 환경변수 안내 정합화 (`AGENTS.md`, `GEMINI.md`, `CLAUDE.md`)
- [x] GoReleaser 도입 (멀티플랫폼 릴리즈 설정)
- [x] 설정 파일 탐색 기준 보강 (실행파일 위치 우선 + `cwd/config` fallback)
- [x] 설정 파일 미존재 시 기본 config 자동 생성 (실행파일 기준)
- [x] SFTP 서버 1차 구현 (계정 인증/Space 권한 연동 + 상태 API/설정 UI 반영)
- [x] SFTP 기본 포트 정책 정리 (`22` -> `2222`)
- [x] 릴리즈 산출물 실행 시 config 자동 생성 검증 (`pnpm release:snapshot`, `config.prod.yaml`)
- [x] 데스크톱 wheel 스크롤 경로 보정 (`FolderContent` 루트 `onWheelCapture` 기반 단일 처리)
- [x] 프론트 의존성 보안 패치 (`react-router` `^7.13.0`)
- [x] Go 런타임/툴체인 보안 패치 (`go 1.25.7`, `govulncheck` 재검증)
- [x] `/api/config` 민감정보 비노출 (`server`만 응답/갱신)
- [x] 공통 에러 응답 하드닝 (계정/Role/Space API의 `err.Error()` 직접 노출 제거)
- [x] 프론트 React Hooks lint 하드닝 (`set-state-in-effect`, `refs` 규칙 대응)
- [x] 다크모드 드래그 선택영역 농도 상향 (테마 클래스 도입 + 다크 오버레이 `40%` 적용)
- [x] 파일 익스플로러 드래그 선택영역 다크/라이트 적응 (overlay를 `--ant-control-item-bg-active` 기반 `color-mix`로 전환)
- [x] 파일 익스플로러 드래그 선택영역 반투명 적용 (`--browse-selection-overlay-bg` 도입, 경계선 유지)
- [x] 파일 익스플로러 드래그 선택영역 투명화 (박스 선택 오버레이 배경 제거, border만 유지)
- [x] 트리 폴더 아이콘/텍스트 수직 정렬 보정 (`FolderTree` switcher flex 정렬 + 공통 아이콘/placeholder 규격화)
- [x] 선택 상태 색상 공통화 (Space 트리/Settings 메뉴/파일 선택을 동일 selection 토큰으로 통일)
- [x] 선택 외곽선/그림자 강조 제거 (테이블 inset box-shadow, 그리드 선택 border/shadow 삭제)
- [x] 모바일 파일익스플로러 터치 스크롤 보정 (`selectionContainer`에 `touchAction: pan-y`, `WebkitOverflowScrolling: touch`, 카드/행 `onTouchMove` 제거)
- [x] 다크모드 그리드/테이블 선택 가시성 강화 (선택 배경/경계 대비 상향 + 뷰 전환 버튼 활성 고대비 스타일)
- [x] 블루-그레이 팔레트 기반 전역 테마 적용 (루트 `ConfigProvider` + 라이트/다크 토큰 시드 + 하드코딩 색상 치환)
- [x] 로그인 화면 배경 회색 처리 (`.login-page` 배경 `--ant-color-bg-layout`, fallback `#f2f3f1`)
- [x] 디렉토리 트리 중복 노출 및 `/dev` 무한 증식 버그 수정
- [x] 디렉토리 트리 확장(`>`) 불능 버그 수정
- [x] Google Drive 스타일 파일 탐색 GUI 구현
- [x] 파일 브라우징 상세 정보(크기, 날짜) 연동
- [x] 폴더 간 내비게이션(Breadcrumb, 더블 클릭 이동) 구현
- [x] Space 클릭 시 해당 디렉토리로 파일 브라우저 이동 연동
- [x] Space와 FolderTree 통합 트리 구조 구현
- [x] Serena MCP 사용 규칙 문서화 (CLAUDE.md)
- [x] 코드 품질 개선 (린트 에러, 중복 코드 제거)
- [x] 문서 구조 통합 (master_rule.md로 모든 규칙 통합)
- [x] Playwright MCP 테스트 절차 추가
- [x] 실행 환경 문서화 (AGENTS.md 생성)
- [x] Space 상대 경로 Breadcrumb 표시 (UX 개선)
- [x] Space 삭제 기능 (Context Menu)
- [x] 파일 표시 버그 수정 (폴더만 표시되던 문제 해결)
- [x] 파일 다운로드 기능 구현
- [x] Space 경로 보안 강화 (Space 외부 경로 접근 차단)
- [x] 파일/폴더 우클릭 컨텍스트 메뉴 구현
- [x] 상위 폴더 버튼 제거 (Breadcrumb만 사용)
- [x] 파일/폴더 이름 변경 기능 (백엔드 API + 모달)
- [x] 파일/폴더 삭제 기능 (백엔드 API + 확인 모달)
- [x] 다운로드를 우클릭 메뉴로만 가능하도록 변경
- [x] 파일 업로드 (Drag & Drop)
- [x] 레이아웃 여백 16px 기준 일괄 통일 (8-grid 준수)
- [x] 서버 상태 표시 개선 (popover 위치, 호스트/포트/경로 표시) (#13)
- [x] WebDAV 루트 디렉토리 가상 Space 목록 노출 (#14)
- [x] 사이드바 트리 노드 증식 버그 수정 (#17)
- [x] 컨텍스트 메뉴 UI 개선 — Ant Design Dropdown 전환 (#19)
- [x] 새 폴더 만들기 기능 (빈 영역 우클릭)
- [x] 파일/폴더 다중 선택 기능 (Ctrl/Cmd/Shift 클릭)
- [x] 선택 시 상단 툴바 표시 (다운로드, 복사, 이동, 삭제)
- [x] 다중 파일 다운로드 (ZIP)
- [x] 싱글/멀티 다운로드 분기 (단일 파일 원본 다운로드, 다중 선택 ZIP)
- [x] 파일 복사/이동 기능 (DestinationPickerModal)
- [x] 다중 삭제 기능
- [x] 정렬 옵션 추가 (폴더 우선 + 이름/수정일/크기 정렬)
- [x] 드래그 앤 드롭 파일 이동 (Google Drive 스타일)
- [x] **Zustand 전역 상태 관리 도입** (완료)
  - [x] Phase 1: Theme Store (localStorage persist)
  - [x] Phase 2: Context Menu Store (ContextMenuContext 제거)
  - [x] Phase 3: Space Store (Props drilling 제거, CRUD actions)
  - [x] Phase 4: Browse Store (파일 탐색 경로, 컨텐츠)
- [ ] **FolderContent.tsx 리팩토링** (진행 중)
  - [x] Phase 1: constants.ts, types.ts, hooks 생성
  - [x] Phase 2: Modal 상태 관리 통합 (useModalManager)
  - [x] Phase 3: 정렬 로직 분리 (useSortedContent)
  - [x] Phase 4: 검증 및 테스트 (`lint/build/go test` 기준)
- [x] 박스 선택 버그 수정 (익스플로러 바깥 동작, 다중선택 안 됨)
- [x] 박스 선택 기능 사용자 테스트 및 검증
- [x] 박스 선택 후 선택 해제 버그 수정
- [x] Settings 페이지 TypeScript 타입 오류 수정 (implicit any 10개)
- [x] 박스 선택 누적 기능 구현 (스크롤 시 선택 유지) (#25)
- [x] Grid 뷰 이미지 썸네일 표시 기능 (ImageThumbnail 컴포넌트, fileTypeUtils)
- [x] 이동/복사 모달 Space 트리 구조 개선 (모든 Space 표시)
- [x] 이동/복사 모달 폴더 선택 시 선택 해제 버그 수정 (Portal 이벤트 버블링 차단)
- [ ] 검색 기능
- [ ] 텍스트 파일 미리보기
- [x] 파일 작업(복사/이동/삭제/이름변경/폴더생성) 후 트리 자동 invalidate 반영
- [x] 트리 targeted invalidation 최적화 (영향 노드만 부분 갱신) (#35)
- [x] 실행 환경 문서 위치 정리 (`docs/AGENTS.md` → `AGENTS.md`)
- [x] Folder Explorer Grid 자동 컬럼 배치(auto-fit/minmax) 및 가로 스크롤 억제 레이아웃 적용
- [x] antd 정적 message/Modal 경고 제거 (`App.useApp` 전환, Settings `App` 프로바이더 추가)
- [x] Space 생성 모달 이름/설명 입력 가능 상태 개선 및 설명(`space_desc`) 저장 연동
- [x] Table 뷰 스크롤 복구 (하단 항목 접근 가능)
- [x] Status 팝오버 웹 접근 기준 표기 개선 (`/api` 표기 제거, WEB 접근 주소 표시)
- [x] Status WEB 접근 주소 계산 책임 분리 (백엔드 하드코딩 제거, 프론트 origin 기준)
- [x] Status WEB 포트 표시 복원 (프론트 origin 기반 포트 표기)
- [x] Status 웹 접근 주소 다중 노출 복원 (localhost + LAN IP, 웹 포트 기준)
- [x] Status 프로토콜 순서 고정 (`WEB -> WebDAV -> SFTP`)
- [x] Status 팝오버 섹션 재배치 (`Hosts` 상단, `Protocols` 하단)
- [x] Status 프로토콜 경로 표기 정리 (끝 슬래시 제거: `:5176`, `:3000/dav`)
- [x] FTP 기능 제거 (백엔드 모듈/설정/API + 프론트 설정 UI/상태 팝오버)
- [x] Main 네비게이션 Drawer 도입 (모바일 기본 + 데스크톱 병행)
- [x] 모바일 Grid(앨범) 2열 기본화 + 헤더 테마 토글 제거(설정으로 단일화)
- [x] 모바일 폴더 단일 탭 진입 적용 (더블클릭 의존 제거)
- [x] 모바일 롱프레스 선택모드 전환 + 멀티선택 UX 적용
- [x] 모바일 내부 드래그 이동 비활성화 (폴더/파일 끌어 이동 차단)
- [x] PC Grid 박스선택을 실시간 교차 모드로 전환 (#60)
- [x] 업로드/설정 버튼을 아이콘 전용 UI로 전환
- [x] 트리 메뉴 확장 아이콘을 화살표에서 폴더 상태 아이콘으로 전환
- [x] 모바일 선택 툴바 위치를 하단에서 상단으로 이동
- [x] 모바일 선택 툴바 단순화 (`:`/액션시트 제거, 복사/다운로드 툴바 직접 배치, 삭제 우측 정렬)
- [x] 모바일 선택모드에서 상단 헤더를 선택 전용 툴바로 전환
- [x] PC/모바일 이동 아이콘(`drive_file_move`) 일원화
- [x] PC 모달 오픈 상태에서 배경 클릭 시 선택 변경 버그 수정 (박스선택 전역 이벤트 차단)
- [x] 파일 목록 스크롤바 경량 스타일 적용 (네이티브 유지 + 얇은 thumb 테마, 커스텀 인디케이터 제거)
- [x] Grid 레이아웃을 남는 가로 영역까지 채우도록 조정 (`auto-fill + minmax(172px, 1fr)`)
- [x] Main/Settings 헤더·사이드 레이아웃 공통 클래스(`layout-*`) 도입 및 적용
- [x] Settings 공통 컴포넌트(`SettingSectionHeader`, `SettingRow`) 도입
- [x] 공통 헤더 컴포넌트(`HeaderBrand`, `HeaderGroup`) 도입 및 메인/세팅 적용
- [x] Settings 잔여 인라인 스타일(`Select/Divider/InputNumber/Alert`) 공통 클래스화
- [x] MainLayout/MainSider 잔여 인라인 스타일 공통 클래스화 (`layout-content-scroll-hidden`, `layout-sider-title`)
- [x] FTP 서버 1차 구현 (Space 가상 루트, start/stop lifecycle, status 연동) (#70)
- [x] 계정 관리 1차 백엔드 구현 (admin/user + Space 권한 + FTP 인증/권한 연동) (#72)
- [x] Settings 계정관리 페이지 추가 (목록/생성/수정/삭제, `/api/accounts` 연동)
- [x] JWT 로그인 1차 구현 (login/refresh/logout/me + API 인증 미들웨어 + 프론트 로그인 라우트/가드)
- [x] Settings `내 프로필` 섹션 추가 (사용자 정보 표시 + 로그아웃)
- [x] 프론트 API 호출 전역 401 처리(`apiFetch`) 및 인증 만료 시 로그인 리다이렉트
- [x] 보안 하드닝: 프로덕션 JWT 시크릿 강제 + 프록시 HTTPS Secure 쿠키 처리
- [x] API 권한 체크를 권한 키 기반으로 1차 전환 (`account.*`, `server.config.*`)
- [x] `/api/auth/me` 응답에 `permissions` 포함 및 Settings 권한 기반 메뉴 노출 제어
- [x] 권한 2차: `space/file` API 권한 매핑 및 Space 리소스 권한 체크 미들웨어 연동
- [x] 권한 2차: 파일 탐색기 쓰기 액션 UI를 `file.write` 권한 기반으로 제한
- [x] 편집형 RBAC 1차: 역할/권한 DB 스키마(`roles`, `permissions`, `role_permissions`) 및 기본 시드 적용
- [x] 편집형 RBAC 1차: 역할 CRUD/권한 매핑 API(`GET/POST/DELETE /api/roles`, `PUT /api/roles/{name}/permissions`) 추가
- [x] 편집형 RBAC 1차: 설정 `권한 관리` 화면에서 역할 추가/삭제/권한 저장 UI 구현
- [x] 계정 관리 역할 선택 옵션을 서버 역할 목록 조회 기반으로 전환
- [x] RBAC 하드닝: 사용 중 Role 삭제 차단 + 시스템 Role 빈 권한 저장 차단
- [x] 권한 변경 즉시 세션 갱신(refreshSession)으로 현재 사용자 권한 반영
- [x] RBAC 관련 회귀 테스트 추가(`service_rbac_test`, `permissions_test`)
- [x] Space 절대경로 비노출 1차: `/api/spaces`에서 `space_path` 제거 + Space browse `path` 상대경로화
- [x] 탐색기 경로 모델을 Space 상대경로 기반으로 정리(트리/브레드크럼/파일작업)
- [x] BottomSheet 터치 드래그 중 passive 이벤트 `preventDefault` 경고 수정
- [x] BottomSheet 본문 스크롤 top 도달 후 시트 하강 드래그 전환 UX 적용
- [x] BottomSheet 테스트용 임시 메뉴 30개 추가 (모바일 액션시트)
- [x] BottomSheet 테스트용 임시 메뉴 제거 (운영 UI 정리)
- [x] BottomSheet `snapPoints=1` 허용 및 모바일 액션시트 최대 높이 `1` 적용
- [x] BottomSheet 한 제스처 내 `스크롤 소모 -> 시트 하강` 연속 전환 보강
- [x] BottomSheet 터치 입력 native listener(`touchmove passive:false`) 전환 + 포인터 터치 경로 분리
- [x] BottomSheet Hook 순서 오류 수정 (`shouldRender` 조기 반환 위치 이동)
- [x] BottomSheet 본문 스크롤 우선/Top-down 시트 드래그 모드 분리 적용
- [x] BottomSheet 전환 끊김 완화 (ref 기반 연속 계산 + touch listener 재등록 최소화)
- [x] BottomSheet top 도달 첫 프레임 잔여 이동량 전달 보정 (`fromContentScroll`, `lastTouchY`)
- [x] BottomSheet 드래그 렌더링을 `height` 기반에서 `translateY` 기반으로 전환
- [x] BottomSheet 하강 후 상향 드래그 시 복귀 불가 버그 수정 (`dragOffset > 0`일 때 drag 모드 유지)
- [x] 설정 > 계정관리 테이블 모바일 UI 보정 (`scroll.x`, 컬럼 축약, 액션 wrap)
- [x] 모바일 공통 하단 잘림 완화 (`layout 100dvh`, safe-area 하단 패딩, FileExplorer 높이 보정)
- [x] 폴더콘텐츠 테이블 멀티선택 안정화 (`useFileSelection` 앵커 ref 추적)
- [x] BottomSheet/컨텍스트 메뉴 `이동` 아이콘 정렬 보정 (`move-action-icon` 공통화)
- [x] 공통 헤더 높이 소폭 축소 (`layout-header: 56px`)
- [x] 파일 익스플로러 좌우 여백에서도 박스선택 드래그 시작 가능하도록 컨테이너 범위 보정
- [x] 외곽 패딩 유지 상태에서 selection 컨테이너 음수마진/패딩으로 여백 드래그 가능 영역 편입
- [x] 모바일/PC 선택모드 상단 로우를 고정 높이 슬롯 교체로 전환하여 본문 점프 제거
- [x] 상단 고정 툴바 위 간격 보정 (`top row marginTop: 8px`, content `paddingTop: 16px` 유지)
- [x] 박스선택 시작영역 확장 옵션(`startAreaOutsetPx`) 호출부 누락 연결 (`FolderContent`)
- [x] 박스선택 오버레이를 루트 레이어로 이동해 컨테이너 경계 클리핑 제거
- [x] 프론트 빌드 타입 에러 정리 (`FolderContentTable`, `useContextMenu`)
- [x] 기본 브레드크럼/툴바 로우 드래그 허용 + 선택 툴바만 드래그 제외
- [x] PC 테이블 선택 반응/멀티선택 UX 보정 (row drag off, Shift/Ctrl+Shift 동작 정리, sortedContent 인덱스 정합)
- [x] 브레드크럼 툴바 가로 스크롤바 제거 및 기본 상단 여백 축소
- [x] 상단 툴바/선택바 전환 시 본문 높이 점프 회귀 수정(고정 슬롯 적용)
- [x] 그리드 선택 강조를 border -> outline 전환하여 선택 시 레이아웃 밀림 제거
- [x] 테이블 뷰 보조 텍스트를 `용량 | 날짜` 형식으로 조정- [x] 브레드크럼 제거 및 하단 현재경로 바 밀착형 스타일 적용- [x] breadcrumb 이동 기능을 상단에서 제거하고 하단 고정 경로바로 이전
- [x] 하단 경로바 breadcrumb 텍스트 색상 기본톤(`colorText`)으로 보정
- [x] 하단 경로바에 아이콘+라벨(`현재 경로`/모바일 `경로`) 시안 적용
- [x] 스페이스 트리/하단 경로바에 스페이스(HDD) vs 폴더 아이콘 구분 적용
- [x] 스페이스 트리 전용 아이콘 제거 + 하단 경로바 스페이스/폴더 아이콘 통일
- [x] 다크모드에서 약한 선택색 문제 해결을 위해 브라우즈 선택/드래그오버 색상을 Ant 테마 토큰 기반으로 통일
- [x] 하단 경로바 breadcrumb가 실제 overflow일 때만 중간 축약(`...`)되도록 동적 처리
- [x] 상단 툴바 좌측에 이전/다음 히스토리 버튼 추가 및 우측에 업로드/정렬/뷰모드 전환 정렬
- [x] 모바일 파일 익스플로러(table/grid) 스크롤 입력 경로 보정 (touch pan 시 롱프레스 취소, 선택바 capture preventDefault 제거, 모바일 브레이크포인트 휠 라우팅 활성화)
- [x] 파일 익스플로러 루트 `onWheelCapture` 휠 보정 제거 및 네이티브 스크롤 경로로 단순화
