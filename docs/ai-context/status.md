# 프로젝트 상태 (Status)

## 현재 진행 상황
- **모바일 선택모드 헤더 전환 완료** (2026-02-15):
    - 모바일 선택모드에서는 하단 툴바 대신 상단 헤더 영역을 선택 전용 툴바(`X/개수/이동/복사/다운로드/:`)로 전환.
    - 하단 액션시트는 `:` 버튼으로 유지하고, 보조 액션(`이름 변경`, `삭제`)을 배치.
    - 검증: `pnpm -C apps/frontend lint`, `pnpm -C apps/frontend build` 통과.
- **모바일 선택 툴바 구조 단순화 완료** (2026-02-15):
    - 모바일 선택 툴바를 하단 배치로 복원하고 `safe-area`를 반영해 하단 잘림을 방지.
    - `:` 버튼 및 하단 액션시트를 제거하고, `복사`/`다운로드`를 툴바 직접 액션으로 이동.
    - `삭제` 버튼을 우측 끝에 배치해 위험 액션을 분리.
    - 검증: `pnpm -C apps/frontend lint`, `pnpm -C apps/frontend build` 통과.
- **모바일 선택 툴바 상단 배치 + 린트 안정화 완료** (2026-02-15):
    - 모바일 선택 툴바/터치 실드의 고정 위치를 하단(`bottom`)에서 상단(`top`)으로 이동.
    - `FolderContent`의 effect 내부 동기 `setState` 경로를 정리해 React Hooks lint 에러 해소.
    - `useBoxSelection`, `useDragAndDrop`, `ServerSettings`의 hook dependency 누락을 보정.
    - 검증: `pnpm -C apps/frontend lint`, `pnpm -C apps/frontend build`, `go test ./...` 통과.
- **트리 메뉴 화살표를 폴더 상태 아이콘으로 전환 완료** (2026-02-15):
    - `FolderTree`에서 기본 화살표(`switcher`) 대신 폴더 닫힘/열림 아이콘으로 확장 상태를 표현.
    - 최종 아이콘 세트는 Material Symbols Rounded(`folder`/`folder_open`)로 확정.
    - 중복 아이콘을 방지하기 위해 `showIcon` 기반 기본 아이콘 렌더링 제거.
    - 검증: `pnpm -C apps/frontend build` 통과.
- **헤더/툴바 아이콘 버튼 텍스트 제거 완료** (2026-02-15):
    - `FolderContentToolbar` 업로드 버튼을 아이콘 전용으로 전환(`aria-label`, `title` 유지).
    - `MainLayout` 설정 버튼을 아이콘 전용으로 전환(`aria-label`, `title` 유지).
    - 검증: `pnpm -C apps/frontend build` 통과.
- **PC Grid 박스선택 실시간 교차 모드 전환 완료** (2026-02-14, #60):
    - `useBoxSelection` 선택 계산을 누적 방식에서 실시간 교차 방식으로 변경.
    - 드래그/스크롤 중 현재 박스와 교차하는 항목 기준으로 선택 집합이 즉시 증감되도록 조정.
    - Ctrl/Cmd/Shift 보조키 정책은 유지하되, 실시간 교차 집합 기준으로 적용.
    - 검증: `pnpm -C apps/frontend build` 통과.
- **모바일 내부 드래그 이동 비활성화 적용 완료** (2026-02-14):
    - 모바일(`sm` 미만)에서는 Grid/Table 아이템의 내부 드래그 이동(`draggable`, `onDrag*`, `onDrop`)을 비활성화.
    - 데스크톱에서는 기존 내부 드래그 이동 동작 유지.
    - 검증: `pnpm -C apps/frontend build` 통과.
- **모바일 롱프레스 선택모드 전환 UX 적용 완료** (2026-02-14):
    - 모바일(`sm` 미만)에서 아이템 롱프레스 시 선택모드로 진입하고, 눌렀던 항목을 첫 선택으로 반영.
    - 선택모드에서는 탭으로 폴더/파일 모두 멀티 선택/해제가 가능하도록 동작 변경.
    - 선택모드가 아닐 때는 폴더 단일 탭 진입을 유지하고, Table 뷰 체크박스는 숨겨 선택 진입 경로를 롱프레스로 일원화.
    - 검증: `pnpm -C apps/frontend build` 통과.
- **모바일 단일 탭 폴더 진입 적용 완료** (2026-02-14):
    - 모바일(`sm` 미만)에서 폴더 항목 단일 탭 시 선택이 아닌 즉시 폴더 진입(`setPath`)되도록 동작 변경.
    - 기존 더블클릭 진입 동작은 데스크톱 흐름으로 유지.
    - 검증: `pnpm -C apps/frontend build` 통과, 모바일 뷰포트 수동 테스트에서 단일 탭 진입 확인.
- **모바일 앨범뷰/헤더 토글 UX 정리 완료** (2026-02-14):
    - Grid(앨범) 뷰에서 모바일 구간(`sm` 미만) 기본 2열 레이아웃(`repeat(2, minmax(0, 1fr))`) 적용.
    - 헤더의 다크/라이트 토글을 제거하고, 테마 변경 진입점을 `설정 > 외관`으로 단일화.
    - 검증: `pnpm -C apps/frontend build` 통과.
- **메인 네비게이션 Drawer 도입 완료** (2026-02-14, #55):
    - `MainLayout`에 `Drawer` 기반 네비게이션 패널을 추가하고 헤더에 `탐색기` 버튼을 배치.
    - 반응형 분기 적용: 모바일(`lg` 미만)은 Drawer 중심, 데스크톱은 기존 고정 Sider 유지 + Drawer 병행 사용.
    - `MainSider`를 `Sider`/`Drawer` 공용으로 재사용 가능하도록 `containerType` 구조로 정리.
    - 모바일 Drawer에서 경로 선택 시 자동 닫힘 처리.
    - 데스크톱 헤더에서는 `탐색기` 버튼을 숨겨 시각적 노이즈를 줄이고, 모바일에서만 노출하도록 조정.
    - 검증: `pnpm -C apps/frontend build` 통과.
- **Status 웹 접근 주소 다중 노출 복원 완료** (2026-02-14):
    - `status.hosts`를 다시 사용해 `localhost`와 LAN IP 주소를 함께 표시.
    - 표시 포트는 백엔드 포트가 아닌 현재 웹 포트(`window.location.port`)로 통일해 `vite host: true` 환경에서도 실제 접속 주소를 노출.
    - 검증: `pnpm -C apps/frontend build` 통과.
- **Status WEB 포트 표시 복원 완료** (2026-02-14):
    - WEB 상태 행에 현재 브라우저 기준 포트(`window.location.port`, 기본 80/443 fallback)를 다시 표시.
    - 포트 계산 책임은 프론트에 유지하고, 표시 형식은 `:{port}/`로 통일.
    - 검증: `pnpm -C apps/frontend build` 통과.
- **Status 웹 접근 포트 계산 책임 분리 완료** (2026-02-14):
    - 백엔드의 WEB 포트 하드코딩(`5173`)을 제거하고, 프론트에서 `window.location.origin`으로 웹 접근 주소를 계산하도록 변경.
    - 개발환경에서는 현재 접속 origin(`:5173`), 프로덕션에서는 내장 서버 origin(`:3000` 등 설정 포트)을 자동 반영.
    - 검증: `go test ./...` (in `apps/backend`), `pnpm -C apps/frontend build` 통과.
- **Status 팝오버 웹 접근 정보 정리 완료** (2026-02-14):
    - `/api/status`의 HTTP 경로 표기를 `/api/`에서 웹 루트(`/`) 기준으로 변경.
    - 상태 팝오버의 HTTP 라벨을 `WEB`으로 조정하고, 접근 주소를 `http://{host}/` 형태로 표시.
    - 검증: `go test ./...` (in `apps/backend`), `pnpm -C apps/frontend build` 통과.
- **Table 뷰 세로 스크롤 복구 완료** (2026-02-13):
    - `FolderContent` 루트에 `minHeight: 0`을 추가해 내부 스크롤 영역 축소/확장이 가능하도록 조정.
    - Table 뷰를 `flex:1 + overflowY:auto` 래퍼로 감싸 하단 항목까지 스크롤 가능하도록 수정.
    - 검증: `pnpm -C apps/frontend build` 통과.
- **Space 생성 모달 입력/설명 전달 개선 완료** (2026-02-13):
    - `DirectorySetupModal`의 이름/설명 입력 비활성 조건을 전역 `spaceStore.isLoading`에서 분리하고, 로컬 `isCreating` 상태로 제출 시점에만 잠그도록 변경.
    - 설명 입력값(`spaceDesc`)을 Space 생성 API payload(`space_desc`)로 전달하도록 `spaceStore.createSpace` 시그니처 확장.
    - 브라우저 확인: `새 Space 생성` 모달에서 이름/설명 입력 가능 확인.
    - 검증: `pnpm -C apps/frontend build` 통과.
- **싱글/멀티 다운로드 분기 처리 완료** (2026-02-13):
    - 프론트엔드 `handleBulkDownload`에서 선택 항목이 1개일 때 `download` 단일 API를 호출하도록 분기.
    - 멀티 선택(2개 이상)일 때만 `download-multiple` ZIP API를 호출하도록 유지.
    - 백엔드 `download-multiple`에도 안전 분기 추가: 요청 경로가 1개 파일이면 ZIP 없이 원본 스트리밍, 1개 폴더면 ZIP, 2개 이상은 ZIP.
    - 검증: `pnpm -C apps/frontend build`, `go build ./...` (in `apps/backend`) 통과.
- **Ant Design message 컨텍스트 경고 제거 완료** (2026-02-13):
    - `/settings` 라우트에 `antd` `App` 프로바이더를 추가해 메시지 컨텍스트를 보장.
    - 정적 `message`/`Modal.confirm` 호출을 `App.useApp()` 기반 호출로 전환.
    - 검증: `pnpm -s build` (in `apps/frontend`) 통과.
- **Folder Explorer 가로 스크롤 최소화 및 자동 컬럼 배치 적용 완료** (2026-02-13):
    - Grid 카드 레이아웃을 `auto-fit + minmax` 기반의 자동 컬럼 배치로 전환.
    - 카드 단일 노출 시 과도한 확장을 방지하기 위해 카드 최대 폭(220px) 제한을 적용.
    - 외곽 컨테이너 스크롤을 숨기고, Grid 영역을 `overflowY` 중심으로 분리하여 가로 스크롤 발생을 억제.
    - Toolbar/SelectionBar에 wrap을 적용해 좁은 해상도에서 버튼/경로가 줄바꿈되도록 개선.
    - 썸네일을 `cover` 기준으로 카드 프리뷰 영역에 밀착되게 표시하고, 카드/그리드 간격을 더 촘촘하게 조정.
    - 검증: `pnpm -C apps/frontend build` 통과, 1200/900/700 폭에서 가로 오버플로우 없음 확인.
- **트리 targeted invalidation 최적화 완료** (2026-02-13, #35):
    - 전역 리셋 방식(`treeRefreshVersion` 단독)에서 경로 기반 무효화 타깃(`treeInvalidationTargets`) 방식으로 확장.
    - 파일 작업 후 영향 경로(소스 부모/대상 부모)만 invalidate 하도록 변경.
    - `FolderTree`에서 타깃 노드만 children/loaded state를 부분 무효화하고, 영향 없는 노드는 유지.
    - 메인 사이드바 트리와 DestinationPickerModal 트리 모두 동일 store 이벤트를 통해 일관 갱신.
    - 검증: `pnpm -C apps/frontend lint`, `pnpm -C apps/frontend build` 통과.
- **기능 구현 완료**: Google Drive 스타일의 파일 탐색 GUI 구현.
    - 백엔드 API 고도화 (파일 크기, 수정일 정보 추가).
    - 프론트엔드 `FolderContent`를 `Table` 기반으로 전면 개편.
    - Breadcrumb 내비게이션 및 폴더 진입/탐색 기능 추가.
- **버그 수정**: 트리 중복 생성 및 확장 불능 문제 해결 상태 유지 확인.
- **Space 연동 완료** (2026-02-04):
    - **통합 트리 구조**: Space 목록과 FolderTree를 하나의 트리로 완전 통합.
    - Spaces가 트리의 루트 노드로 표시, 확장 시 해당 Space의 하위 디렉토리 로드.
    - Space 메뉴 제거, 단일 트리 구조로 단순화.
    - `FolderTree`가 `spaces` prop을 받아 Space 노드 생성 및 lazy loading 처리.
    - `MainSider`: Spaces 헤더 + 버튼, 통합 FolderTree.
    - `FileExplorer` 단순화: FolderContent만 전체 화면으로 표시.
    - 모달에서는 `showBaseDirectories` 플래그로 시스템 디렉토리 탐색.
    - 파일: `MainLayout/index.tsx`, `MainSider.tsx`, `FileExplorer.tsx`, `FolderTree.tsx` 수정.
- **코드 품질 개선** (2026-02-04):
    - Serena MCP 필수 사용 규칙을 `CLAUDE.md`에 추가.
    - 여러 Serena replace_symbol_body 사용 시 발생한 중복 코드 제거.
    - ESLint 에러 수정: 파싱 에러, 사용하지 않는 import, any 타입 등.
    - React 권장 패턴 준수: useEffect에서 setState 제거, 올바른 폼 초기화.
    - 테마 대응: 텍스트 색상이 다크/라이트 모드에 맞춰 자동 변경.

- **문서 구조 개편** (2026-02-04):
    - `CLAUDE.md`를 `.claude/CLAUDE.md`로 이동 (Claude Code CLI 전용 설정).
    - `GEMINI.md` 간소화: "docs/master_rule.md를 먼저 읽기"로 단순화.
    - `docs/master_rule.md`에 모든 규칙 통합:
        - Playwright MCP 브라우저 테스트 절차 추가.
        - 디자인 규칙 (8px 그리드, 일관된 radius 등) 명시.
        - 커밋 메시지 규칙 (한글, 간결체) 추가.
        - Serena MCP 사용 상세 규칙을 GEMINI.md에서 이동.
    - `.gitignore`에 테스트/디버깅 디렉토리 추가 (.playwright-mcp/, .serena 등).

- **문서 구조 개선** (2026-02-04):
    - `docs/AGENTS.md` 생성: 실행 환경 정보 통합 문서.
        - 프로젝트 구조, 서버 실행, 빌드, 포트 정보.
        - 테스트 방법, 트러블슈팅, 패키지 관리.
    - `.claude/CLAUDE.md`, `GEMINI.md` 수정: AGENTS.md 읽기 추가.
- **Space 상대 경로 Breadcrumb 구현 완료** (2026-02-04):
    - FolderTree: Space 선택 시 Space 정보도 함께 전달하도록 수정.
    - MainLayout: selectedSpace state 추가 및 Outlet context에 포함.
    - FileExplorer: OutletContext에 selectedSpace 추가.
    - FolderContent: Space 상대 경로로 Breadcrumb 표시.
        - Space 선택 시: "SpaceName / folder1 / folder2" 형식.
        - Space 미선택 시: 기존 절대 경로 유지.
    - 타입 에러 수정 (FolderContent, DirectorySetupModal).
    - Playwright 브라우저 테스트 완료: Breadcrumb 정상 작동 확인.

- **Space 삭제 기능 구현 완료** (2026-02-04):
    - FolderTree: Space 노드에 Context Menu (Dropdown) 추가.
    - MainSider: useDeleteSpace 훅 사용하여 삭제 로직 구현.
    - 삭제 확인 Modal (Modal.confirm) 추가.
    - 삭제 후 Space 목록 자동 갱신.
    - 성공/실패 메시지 표시 (message.success/error).
    - Playwright 브라우저 테스트 완료: Context Menu, 확인 모달, 삭제 후 트리 갱신 모두 정상 작동 확인.

- **파일 표시 버그 수정 완료** (2026-02-04):
    - 문제: FolderContent에서 폴더만 표시되고 파일이 표시되지 않음.
    - 원인: `browse_handler.go`의 `ListDirectory` 호출 시 `isOnlyDir` 파라미터가 `true`로 설정되어 있어 파일 필터링.
    - 해결: `apps/backend/internal/browse/handler/browse_handler.go:51` 라인 수정.
        - 변경 전: `h.browseService.ListDirectory(true, targetPath)`
        - 변경 후: `h.browseService.ListDirectory(false, targetPath)`
    - 결과: 오른쪽 FolderContent에서 폴더와 파일이 모두 정상 표시.
    - Playwright 브라우저 테스트 완료: 파일 아이콘, 크기, 수정일 모두 정상 표시 확인.

- **파일 다운로드 기능 구현 완료** (2026-02-04):
    - 백엔드: `/api/browse/download` 엔드포인트 추가.
        - 파일 경로를 쿼리 파라미터로 받아 파일 다운로드 제공.
        - Content-Disposition 헤더로 파일명 설정.
        - 디렉토리 다운로드 방지, 권한 및 존재 여부 검증.
    - 프론트엔드: FolderContent에서 파일 클릭 시 다운로드.
        - 폴더: 클릭 시 해당 폴더로 이동 (기존 동작 유지).
        - 파일: `<a href="/api/browse/download?path=..." download>` 링크로 다운로드.
    - 수정 파일:
        - `apps/backend/internal/browse/handler/browse_handler.go` (handleDownload 추가)
        - `apps/frontend/src/features/browse/components/FolderContent.tsx` (파일 링크 수정)
    - Playwright 브라우저 테스트 완료: README.md 다운로드 정상 작동 확인.

- **Space 경로 보안 강화 완료** (2026-02-04):
    - 문제: Space로 할당되지 않은 시스템 경로에도 접근 가능한 보안 취약점.
    - 해결: Space 경로 검증 기능 추가.
    - 백엔드:
        - `browse_handler.go`에 `isPathAllowed` 함수 추가.
        - 요청 경로가 등록된 Space의 하위 경로인지 검증.
        - Space가 없을 때는 모든 경로 허용 (하위 호환성).
        - `system=true` 쿼리 파라미터로 시스템 탐색 모드 지원 (Space 생성용).
        - browse/download API에서 경로 검증 수행.
    - 프론트엔드:
        - `useBrowseApi.ts`: `fetchDirectoryContents`에 `systemMode` 파라미터 추가.
        - `FolderTree.tsx`: Space 생성 모달(`showBaseDirectories`)에서 `systemMode=true` 전달.
    - 수정 파일:
        - `apps/backend/internal/browse/handler/browse_handler.go`
        - `apps/backend/main.go` (spaceService 주입)
        - `apps/frontend/src/features/browse/hooks/useBrowseApi.ts`
        - `apps/frontend/src/features/browse/components/FolderTree.tsx`
    - 결과:
        - 일반 탐색: Space 경로만 접근 가능, 403 에러로 차단.
        - Space 생성: 시스템 전체 탐색 가능 (충돌 없음).
    - Playwright 브라우저 테스트 완료: Space 탐색 정상, 시스템 탐색 정상.

- **파일/폴더 컨텍스트 메뉴 구현 완료** (2026-02-05):
    - 상위 폴더 버튼 삭제: Breadcrumb만으로 탐색하도록 UI 단순화.
    - 파일/폴더 우클릭 컨텍스트 메뉴 추가:
        - 파일: "다운로드", "이름 변경", "삭제" 메뉴.
        - 폴더: "이름 변경", "삭제" 메뉴 (다운로드 제외).
    - 구현:
        - `FolderContent.tsx`: 컨텍스트 메뉴 상태 관리 및 렌더링.
        - Table의 `onRow` 이벤트에 `onContextMenu` 추가.
        - Menu 컴포넌트로 컨텍스트 메뉴 표시.
        - 파일 타입에 따라 메뉴 항목 조건부 표시.
    - TODO: 이름 변경, 삭제 기능 백엔드 API 및 실제 동작 구현.
    - Playwright 브라우저 테스트 완료: 상위 폴더 버튼 제거 확인, 파일/폴더별 컨텍스트 메뉴 정상 작동.

- **파일/폴더 이름 변경 및 삭제 기능 구현 완료** (2026-02-05):
    - 파일 이름 클릭 시 다운로드 제거: 우클릭 메뉴로만 다운로드 가능.
    - 백엔드 API 추가:
        - `/api/browse/rename`: 파일/폴더 이름 변경 (POST).
        - `/api/browse/delete`: 파일/폴더 삭제 (POST).
        - Space 경로 검증: 요청 경로와 새 경로 모두 허용된 Space 내부인지 확인.
        - 폴더 삭제: `os.RemoveAll`로 하위 파일 포함 전체 삭제.
    - 프론트엔드 구현:
        - 이름 변경 모달: 현재 이름이 입력 필드에 표시, Enter 키로 확인.
        - 삭제 확인 모달: `Modal.confirm`으로 확인 후 삭제.
        - API 호출 후 성공/실패 메시지 표시 (`message.success/error`).
        - 작업 완료 후 디렉토리 목록 자동 새로고침.
    - 수정 파일:
        - `apps/backend/internal/browse/handler/browse_handler.go`
        - `apps/frontend/src/features/browse/components/FolderContent.tsx`
    - Playwright 브라우저 테스트 완료:
        - 파일 이름 클릭 시 다운로드 안 됨 확인.
        - 이름 변경 모달 및 실제 변경 작동 확인.
        - 삭제 확인 모달 및 실제 삭제 작동 확인.
        - 목록 자동 새로고침 확인.

- **파일 업로드 기능 구현 완료** (2026-02-05):
    - 백엔드 API 추가:
        - `POST /api/browse/upload`: multipart/form-data로 파일 업로드.
        - 요청: `file` (파일), `targetPath` (업로드 대상 디렉토리), `overwrite` (선택, 덮어쓰기 여부).
        - Space 경로 검증: 업로드 대상 경로가 Space 내부인지 확인.
        - 파일 중복 확인: 동일 이름 파일 존재 시 409 Conflict 에러 (overwrite=false).
        - 덮어쓰기 지원: `overwrite=true`일 때 기존 파일 덮어쓰기.
        - 최대 업로드 크기: 32MB.
    - 프론트엔드 구현:
        - Ant Design `Upload.Dragger` 컴포넌트 사용.
        - Drag & Drop 또는 클릭으로 파일 선택.
        - `customRequest`로 커스텀 업로드 로직 구현.
        - 409 에러 발생 시 `Modal.confirm`으로 덮어쓰기 확인.
        - 덮어쓰기 확인 시 `overwrite=true`로 재업로드.
        - 업로드 성공 시 메시지 표시 및 목록 자동 새로고침.
        - FolderContent 상단에 업로드 영역 배치.
    - 수정 파일:
        - `apps/backend/internal/browse/handler/browse_handler.go` (handleUpload 추가)
        - `apps/frontend/src/features/browse/components/FolderContent.tsx` (Upload.Dragger 추가)
    - Chrome Extension 브라우저 테스트 완료:
        - Drag & Drop 영역 정상 표시.
        - 파일 업로드 API 정상 작동 (test-upload.txt 업로드 성공).
        - 업로드된 파일이 목록에 즉시 표시됨.
        - 중복 파일 업로드 시 덮어쓰기 확인 모달 정상 작동.
        - 덮어쓰기 기능 정상 작동 (duplicate-test.txt 테스트 완료).

- **뷰 전환 기능 구현 완료** (2026-02-05):
    - 테이블 뷰와 그리드 뷰를 전환할 수 있는 기능 추가.
    - 구현 내용:
        - 뷰 모드 state 추가 ('table' | 'grid').
        - Breadcrumb 우측에 뷰 전환 버튼 추가.
        - 버튼 아이콘: UnorderedListOutlined (테이블), AppstoreOutlined (그리드).
        - 활성 버튼은 primary 타입으로 강조.
    - 그리드 뷰 구현:
        - Ant Design Row/Col과 Card 컴포넌트 사용.
        - 반응형 그리드: xs=12, sm=8, md=6, lg=4, xl=3 (화면 크기별 열 수 조정).
        - 카드 내용: 큰 아이콘 (48px), 파일 이름, 파일 크기 (파일만).
        - 폴더 더블 클릭 시 이동 기능 유지.
        - 우클릭 컨텍스트 메뉴 기능 유지.
    - 수정 파일:
        - `apps/frontend/src/features/browse/components/FolderContent.tsx` (뷰 전환 버튼, 그리드 뷰 추가)
    - Chrome Extension 브라우저 테스트 완료:
        - 뷰 전환 버튼 정상 표시.
        - 테이블 ↔ 그리드 양방향 전환 정상 작동.
        - 그리드 뷰에서 파일/폴더 정상 표시.
        - 그리드 뷰에서 폴더 더블 클릭 이동 정상 작동.

- **업로드 UI 개선 완료** (2026-02-05):
    - Upload.Dragger 섹션 제거, 화면 공간 효율화.
    - 전체 영역 드래그 앤 드롭 지원:
        - 파일 드래그 시 반투명 파란색 오버레이 표시.
        - "파일을 놓아 업로드" 메시지 및 아이콘 표시.
        - 드롭 시 파일 업로드 시작.
    - 업로드 버튼 추가:
        - 위치: Breadcrumb 우측, 뷰 전환 버튼 옆.
        - UploadOutlined 아이콘 + "업로드" 텍스트.
        - 클릭 시 파일 선택 대화상자 열림.
    - 숨겨진 file input으로 파일 선택 처리.
    - 드래그/버튼 모두 동일한 업로드 로직 사용 (중복 확인 포함).
    - 수정 파일:
        - `apps/frontend/src/features/browse/components/FolderContent.tsx` (드래그 이벤트, 업로드 버튼 추가)

- **Breadcrumb 절대 경로 버그 수정 완료** (2026-02-06):
    - 문제: 하위 폴더(2+ depth) 이동 시 breadcrumb이 절대 경로로 표시됨.
    - 원인:
        - FolderTree에서 Space 노드가 아닌 하위 폴더 선택 시 Space 정보 없이 경로만 전달.
        - FolderContent에서 폴더 더블 클릭 시 `onPathChange(path)` 호출로 `selectedSpace` 미업데이트.
        - `selectedSpace`가 현재 경로와 동기화되지 않아 breadcrumb 로직 실패.
    - 해결:
        - `MainLayout/index.tsx`의 `handlePathSelect` 함수 수정.
        - Space가 명시적으로 전달되지 않으면 현재 경로에서 해당하는 Space 자동 탐색.
        - `spaces.find(s => path.startsWith(s.space_path))`로 매칭되는 Space 찾기.
        - 찾은 Space를 `selectedSpace`에 설정하여 breadcrumb이 항상 올바른 상대 경로 표시.
    - 수정 파일:
        - `apps/frontend/src/components/layout/MainLayout/index.tsx` (handlePathSelect 로직 개선)
    - Chrome Extension 브라우저 테스트 완료:
        - Space 선택 후 하위 폴더로 이동 시 상대 경로 정상 표시 ("헬로 / Test Folder").
        - 2+ depth 폴더 이동 시에도 상대 경로 정상 표시 ("헬로 / Test Folder / Contents / Frameworks").

- **폴더 ZIP 다운로드 기능 구현 완료** (2026-02-06):
    - 백엔드: `handleDownload()` 함수 수정하여 폴더/파일 자동 구분 처리.
    - 백엔드: `downloadFolderAsZip()` 함수 추가로 폴더 압축 다운로드 지원.
        - Go 표준 라이브러리 `archive/zip` 사용 (외부 의존성 없음).
        - HTTP response에 직접 스트리밍 (메모리 효율적).
        - `filepath.Walk()`로 재귀적 폴더 탐색.
        - 심볼릭 링크 자동 스킵 (보안).
        - 압축 파일명: `{folderName}.zip`.
    - 프론트엔드: 컨텍스트 메뉴에 폴더 다운로드 옵션 추가.
        - 파일: "다운로드" 메뉴 표시.
        - 폴더: "폴더 다운로드 (ZIP)" 메뉴 표시.
    - 수정 파일:
        - `apps/backend/internal/browse/handler/browse_handler.go` (import 추가, handleDownload 수정, downloadFolderAsZip 추가)
        - `apps/frontend/src/features/browse/components/FolderContent.tsx` (컨텍스트 메뉴 조건 수정)
    - Chrome Extension 브라우저 테스트 완료:
        - 폴더 우클릭 시 "폴더 다운로드 (ZIP)" 메뉴 정상 표시.
        - 파일 우클릭 시 "다운로드" 메뉴 정상 표시.
        - Test Folder.zip 다운로드 성공.
        - zip 파일 내부에 모든 하위 폴더/파일 구조 정상 포함.

- **그리드 뷰 기본값 변경 완료** (2026-02-06):
    - 파일 탐색기의 기본 뷰를 테이블에서 그리드로 변경.
    - `FolderContent.tsx`의 `viewMode` 초기값을 'table'에서 'grid'로 수정.
    - 수정 파일:
        - `apps/frontend/src/features/browse/components/FolderContent.tsx` (viewMode 기본값 변경)
    - Chrome Extension 브라우저 테스트 완료:
        - Space 선택 시 그리드 뷰가 기본으로 표시.
        - 파일/폴더가 카드 형태로 정상 표시.
        - 뷰 전환 버튼에서 그리드 버튼이 활성화 상태.

- **레이아웃 여백 통일 완료** (2026-02-07):
    - 모든 영역의 수평 패딩을 8-grid 기준 16px로 일괄 통일.
    - Header: antd 기본값(0 50px) → 명시적 `0 16px`.
    - 사이드바 헤더: `12px 16px` → `16px` (12px 8-grid 위반 수정).
    - 사이드바 트리: `8px` → `8px 16px` (수평 패딩 통일).
    - 메인 콘텐츠: `24px` → `16px` (수평 패딩 통일).
    - 수정 파일: `MainLayout/index.tsx`, `MainSider.tsx`, `FileExplorer.tsx`.
    - Chrome Extension 브라우저 테스트 완료: 다크/라이트 모드, 그리드/테이블 뷰 모두 확인.

- **서버 상태 표시 개선** (2026-02-07):
    - Status popover 위치를 텍스트 바로 아래로 변경 (`bottomLeft`).
    - 접근 가능한 호스트 주소 목록 표시 (`net.InterfaceAddrs()`).
    - 각 프로토콜의 포트 및 경로 표시 (HTTP: `:3000/api/`, WebDAV: `:3000/dav/`).
    - 백엔드: `ProtocolStatus`에 `Port`, `Path` 필드 추가, `StatusResponse`에 `Hosts` 필드 추가.
    - 프론트엔드: `ServerStatus.tsx` popover에 호스트, 포트, 경로 정보 표시.

- **WebDAV 루트 디렉토리 가상 Space 목록 노출** (2026-02-07):
    - `/dav/` 접근 시 400 에러 → 모든 Space를 가상 폴더로 표시하도록 수정.
    - `SpaceFS` 커스텀 `webdav.FileSystem` 구현 (`spacefs.go`).
    - 루트(`/`) PROPFIND 시 Space 목록을 가상 디렉토리로 반환.
    - `/{spaceName}/...` 경로는 실제 OS 파일시스템으로 위임.
    - `service.go`에 `GetRootHandler()` 추가, `webdav_handler.go`에서 루트 요청 위임.
    - curl PROPFIND 테스트 완료: 모든 Space가 폴더로 정상 표시.

- **사이드바 트리 노드 증식 버그 수정** (2026-02-07):
    - 문제: 여러 Space를 열고 닫을 때 하위 폴더 노드가 중복 생성.
    - 원인: 같은 디렉토리를 가리키는 Space들의 하위 노드 key가 파일 경로로 동일하여 Ant Design Tree key 충돌.
    - 해결: 자식 노드 key에 부모 Space prefix 추가 (`space-{id}::{path}`), `expandedKeys` 명시적 관리.
    - Chrome Extension 테스트 완료: Space 열고 닫기 반복 시 증식 없음 확인.

- **컨텍스트 메뉴 UI 개선** (2026-02-08):
    - Ant Design `Menu` + `position: fixed` → `Dropdown` 컴포넌트 전환.
    - 공통 `ContextMenu` 컴포넌트 생성 (`src/components/ContextMenu.tsx`).
    - FolderContent, FolderTree의 중복 닫기 로직(document click 리스너) 제거.
    - Dropdown의 자동 화면 경계 보정, 페이드 애니메이션 적용.
    - ESC 키 + 외부 클릭 닫기 지원.
    - Chrome Extension 테스트 완료: 파일/폴더/Space 우클릭 메뉴 정상 동작.

- **새 폴더 만들기 기능 구현 완료** (2026-02-08):
    - 백엔드 API 추가:
        - `POST /api/browse/create-folder`: 폴더 생성 엔드포인트.
        - 요청: `{ parentPath, folderName }`.
        - Space 경로 검증: `isPathAllowed`로 부모 경로 확인.
        - 폴더명 유효성 검증: 특수문자(`/`, `\`, `:` 등) 차단.
        - 중복 폴더 확인: 동일 이름 폴더 존재 시 409 Conflict.
        - `os.Mkdir(folderPath, 0755)`로 폴더 생성.
    - 프론트엔드 구현:
        - 빈 영역 우클릭 컨텍스트 메뉴 추가.
        - 빈 영역 감지 로직: `!target.closest('.ant-card') && !target.closest('tr')`.
        - "새 폴더 만들기" 메뉴 아이템 추가 (FolderOutlined 아이콘).
        - 모달: Input autoFocus, Enter 키 생성, 취소/생성 버튼.
        - 생성 성공 시 메시지 표시 및 목록 자동 새로고침.
    - 수정 파일:
        - `apps/backend/internal/browse/handler/browse_handler.go` (handleCreateFolder, RegisterRoutes)
        - `apps/frontend/src/features/browse/components/FolderContent.tsx` (빈 영역 메뉴, 모달)
    - Chrome Extension 테스트 완료:
        - 빈 영역 우클릭 시 "새 폴더 만들기" 메뉴 정상 표시.
        - 모달 열림, Input autoFocus 정상 작동.
        - 폴더 생성 후 목록 자동 새로고침 확인 (MyNewFolder 생성 성공).
    - 버그 수정 (TypeScript 빌드 에러):
        - 미사용 import 제거: `Upload`, `UploadProps`.
        - 이벤트 핸들러 파라미터 타입 명시:
            - `onContextMenu`: `React.MouseEvent<HTMLElement>`
            - `onChange`: `React.ChangeEvent<HTMLInputElement>`
            - `handleExpand`: `React.Key[]`
            - `handleRightClick`: `{ event: React.MouseEvent; node: any }`
        - 프론트엔드 재빌드 후 정상 동작 확인.

- **파일 브라우저 정렬 기능 구현 완료** (2026-02-09):
    - 정렬 상태 관리 (sortBy, sortOrder).
    - 폴더 우선 정렬 로직 구현 (모든 정렬 옵션에서 폴더가 파일보다 먼저 표시).
    - 그리드 뷰: 상단 정렬 드롭다운 추가 (이름/수정일/크기 × 오름/내림차순 = 6가지 옵션).
    - 테이블 뷰: 컬럼 헤더 클릭 정렬 (onChange 핸들러로 정렬 상태 업데이트).
    - 뷰 전환(테이블 ↔ 그리드) 시 정렬 상태 유지.
    - 기본 정렬: 폴더 우선 + 이름 오름차순.
    - useMemo로 sortedContent 최적화.
    - Chrome Extension 브라우저 테스트 완료: 모든 정렬 옵션 정상 작동 확인.

- **드래그 앤 드롭 파일 이동 기능 구현 완료** (2026-02-09):
    - Google Drive 스타일 드래그 앤 드롭으로 파일/폴더 이동.
    - 모든 파일/폴더 카드에 `draggable={true}` 속성 추가.
    - 드래그 소스 처리:
        - `onDragStart`: 선택되지 않은 항목 드래그 시 자동 선택, dataTransfer에 경로 저장.
        - 데이터 타입: `application/json` with `{type: 'cohesion-internal', paths: [...]}`
    - 드롭 타겟 처리:
        - 폴더에만 드롭 가능, `onDragOver`로 시각적 피드백 (파란 테두리/배경).
        - `onDrop`: 폴더에 드롭 시 해당 폴더로 이동, 자기 자신 이동 방지.
        - 빈 영역 드롭: 현재 폴더에 이동 (같은 폴더면 무시).
    - 외부 파일 업로드와 내부 이동 구분:
        - `dataTransfer.files.length > 0`: 외부 파일 업로드.
        - `dataTransfer.getData('application/json')`: 내부 파일 이동.
    - 텍스트 선택 방지: `userSelect: 'none'` CSS 적용.
    - 다중 선택 지원: 선택된 여러 파일을 한 번에 드래그 이동.
    - 기존 우클릭 메뉴 이동/복사 기능과 병행 사용 가능.
    - 수정 파일: `FolderContent.tsx`
    - Chrome Extension 브라우저 테스트 완료:
        - 단일 파일 드래그 이동 (README.md → docs 폴더).
        - 다중 파일 드래그 이동 (GEMINI.md + package.json → dist 폴더).
        - 외부 파일 업로드 드래그와 충돌 없음.
        - 텍스트 선택 방지 확인.

- **Shift 클릭 범위 선택 버그 수정** (2026-02-09):
    - 문제: 정렬된 상태에서 Shift+클릭 시 원치 않은 항목 선택.
    - 원인: `content` 배열 사용, 화면은 `sortedContent` 표시로 인덱스 불일치.
    - 해결: `handleItemClick`의 Shift+클릭 로직에서 `sortedContent` 사용.
    - 수정 파일: `FolderContent.tsx`
    - 테스트: 크기 정렬 후 9개 항목 범위 선택 성공.
    - 결과: 정렬 상태와 무관하게 화면 순서대로 범위 선택 정상 작동.

- **gopsutil v4 업그레이드** (2026-02-09):
    - macOS 12.0 deprecated API 경고 제거를 위한 의존성 업그레이드.
    - v3.21.11 → v4.26.1 업그레이드.
    - import 경로 변경: `github.com/shirou/gopsutil/disk` → `github.com/shirou/gopsutil/v4/disk`.
    - 빌드 경고 제거, 정상 작동 확인.
    - 수정 파일: `go.mod`, `go.sum`, `internal/browse/service.go`.

- **Space ID 검증 버그 수정** (2026-02-09):
    - 문제: `/api/spaces/` (빈 ID) 요청 시 파싱 에러 발생.
    - 해결: `handleSpaceByID`에서 빈 ID 사전 체크 추가.
    - 에러 메시지 개선: "Space ID is required", "Invalid space ID format".
    - 추가 수정: `/api/spaces` 경로가 `handleSpaceByID`로 잘못 라우팅되는 문제 해결.
    - Chrome extension으로 브라우저 테스트 완료.
    - 수정 파일: `internal/space/handler/space_handler.go`.

- **API 중복 호출 최적화** (2026-02-09):
    - 문제: Space 클릭 시 동일 API 3번 호출 (`/api/browse?path=...`).
    - 원인: StrictMode + 두 개의 독립적인 setState (selectedPath, selectedSpace).
    - 해결: StrictMode 제거, 단일 state 객체로 통합, useCallback 메모이제이션.
    - 결과: 3번 → 2번 호출로 개선 (33% 감소).
    - 남은 이슈: 2번 호출 여전히 발생 (추가 조사 필요).
    - 수정 파일: `main.tsx`, `MainLayout/index.tsx`.

- **Zustand 전역 상태 관리 도입** (2026-02-09, 진행 중):
    - **Phase 1 완료**: Theme Store (다크모드 설정, localStorage 연동).
    - **Phase 2 완료**: Context Menu Store (ContextMenuContext 완전 대체).
    - **Phase 3 완료**: Space Store (Props drilling 제거, CRUD actions 통합).
    - **Phase 4 남음**: Browse Store (파일 탐색 경로, 컨텐츠 상태 통합).
    - Props Drilling 대폭 감소, 코드 일관성 향상, 확장성 개선.
- **박스 선택 기능 버그 수정 완료** (2026-02-10):
    - 문제 1: 익스플로러 바깥에서도 드래그 동작.
        - 해결: `handleMouseDown`에서 `containerRef` 범위 체크 추가.
        - 컨테이너 외부 클릭 시 박스 선택 시작 방지.
    - 문제 2: 드래그해도 파일/폴더 다중선택 안 됨.
        - 해결: `useBoxSelection` 의존성 배열에서 `containerRef` 제거.
        - 핸들러가 올바르게 갱신되어 ref.current 참조 정상화.
    - 문제 3: TypeScript 빌드 에러 (3개).
        - `useBoxSelection`: `containerRef` 타입을 구조적 타이핑(`{ current: HTMLElement | null }`)으로 수정.
        - `FolderContentTable`: `ColumnsType` → `TableColumnsType` import 변경.
        - `useFileOperations`: `error.message` 타입 가드 추가.
    - 문제 4: 박스 드래그 후 마우스 놓으면 선택 해제됨.
        - 원인: `mouseup` → `click` 이벤트 순서로 `handleContainerClick`이 선택 해제.
        - 해결: `wasRecentlySelecting` 플래그 추가하여 박스 선택 직후 click 이벤트 무시.
        - `handleMouseUp`에서 선택 확정 후 플래그 설정, 다음 이벤트 루프에서 해제.
    - 문제 5: 복사/이동 버튼 클릭 시 모달 열리면서 선택 해제됨.
        - 원인: 버튼 클릭 이벤트가 버블링되어 `handleContainerClick`까지 도달.
        - `handleContainerClick`이 버튼 클릭을 빈 영역 클릭으로 인식하여 선택 해제.
        - 해결: `closest('button')`, `closest('input')` 체크 추가하여 버튼/입력 필드 클릭 시 선택 유지.
    - 수정 파일:
        - `apps/frontend/src/features/browse/hooks/useBoxSelection.ts`
        - `apps/frontend/src/features/browse/components/FolderContent.tsx`
        - `apps/frontend/src/features/browse/components/FolderContent/FolderContentTable.tsx`
        - `apps/frontend/src/features/browse/hooks/useFileOperations.ts`
        - `apps/frontend/src/features/browse/constants.tsx`
    - 사용자 테스트 완료: 박스 선택 정상 작동 확인.

- **FolderContent.tsx 리팩토링 Phase 2 완료** (2026-02-10):
    - `useModalManager` 훅 생성하여 모달 상태 관리 통합.
    - 3개 모달(rename, createFolder, destination) 상태를 단일 훅으로 관리.
    - TypeScript 제네릭으로 타입 안전성 확보.
    - 라인 수: 380줄 → 366줄 (-14줄, 3.7% 감소).
    - 중복 코드 제거, 일관성 향상, 확장성 개선.
    - 향후 모달 추가 시 useModalManager에 타입만 추가하면 됨.
    - 수정 파일:
        - `apps/frontend/src/features/browse/hooks/useModalManager.ts` (신규)
        - `apps/frontend/src/features/browse/components/FolderContent.tsx`

- **FolderContent.tsx 리팩토링 Phase 3 완료** (2026-02-10):
    - `useSortedContent` 훅 생성하여 정렬 로직 분리.
    - 폴더 우선 + sortConfig 기반 정렬 로직을 재사용 가능한 훅으로 추출.
    - 라인 수: 366줄 → 341줄 (-25줄, 6.8% 감소).
    - **전체 리팩토링 효과**: 1,194줄 → 341줄 (**71.4% 감소**).
    - 정렬 로직 재사용 가능, 테스트 용이성 향상.
    - 수정 파일:
        - `apps/frontend/src/features/browse/hooks/useSortedContent.ts` (신규)
        - `apps/frontend/src/features/browse/components/FolderContent.tsx`

- **Settings 페이지 TypeScript 타입 오류 수정 완료** (2026-02-11):
    - 문제: Implicit any 타입 오류 10개 발생 (Settings 관련 컴포넌트).
    - 해결:
        - 이벤트 핸들러 파라미터에 명시적 타입 추가.
        - Menu onClick: `{ key: string }`.
        - Select onChange: `string` → `SortBy`, `SortOrder` 타입 캐스팅.
        - Switch onChange: `boolean`.
        - InputNumber onChange: `number | null`.
    - 수정 파일:
        - `apps/frontend/src/pages/Settings/index.tsx` (Menu onClick 타입 추가)
        - `apps/frontend/src/pages/Settings/sections/FileSettings.tsx` (Select 타입 추가 및 캐스팅)
        - `apps/frontend/src/pages/Settings/sections/ServerSettings.tsx` (Switch, InputNumber 타입 추가)
    - 결과: Lint 및 TypeScript 체크 통과 (0 errors).

- **박스 선택 누적 기능 구현 완료** (2026-02-11, #25):
    - 문제: 박스 선택 중 스크롤 시 박스를 벗어난 항목이 선택 해제되는 직관적이지 않은 UX.
    - 해결: 드래그 영역에 한 번이라도 걸린 항목은 계속 선택 유지 (누적 방식).
    - 구현:
        - `accumulatedSelection` ref 추가로 드래그 중 교차한 모든 항목 추적.
        - `handleMouseMove`, `handleScroll`, `handleMouseUp`에서 교차 항목 누적.
        - Ctrl/Shift 모드 지원 유지 (일반: 누적, Shift: 초기+누적, Ctrl: 토글).
        - `updateSelection` 함수 제거하고 각 핸들러에서 직접 선택 계산.
    - 수정 파일:
        - `apps/frontend/src/features/browse/hooks/useBoxSelection.ts` (126줄 추가, 74줄 삭제)
    - Issue: #25 (https://github.com/lteawoo/Cohesion/issues/25)
    - Commit: `1c07bed` (feat: 박스 선택 시 스크롤로 누적 선택 기능 구현)
    - 결과: Grid 뷰에서 드래그 + 스크롤로 많은 파일을 효율적으로 선택 가능, 직관적인 UX 제공.

- **Grid 뷰 이미지 썸네일 표시 기능 구현 완료** (2026-02-11):
    - 문제: Grid 뷰에서 이미지 파일이 일반 파일 아이콘으로 표시되어 이미지 파일 식별이 어려움.
    - 해결: 이미지 파일 자동 감지 및 썸네일 표시 기능 추가.
    - 구현:
        - `ImageThumbnail` 컴포넌트: 로딩/에러 상태 처리, 브라우저 네이티브 lazy loading 활용.
        - `fileTypeUtils` 유틸리티: 이미지 확장자 감지 함수 (jpg, jpeg, png, gif, webp, svg, bmp, ico).
        - `FolderContentGrid`: 이미지 파일 감지 시 썸네일 렌더링, 일반 파일은 기존 아이콘 유지.
        - 기존 `/api/browse/download` 엔드포인트 활용 (별도 썸네일 API 불필요).
        - 프론트엔드 직접 로드 방식 채택 (빠른 구현, 간단한 아키텍처).
    - 수정 파일:
        - `apps/frontend/src/features/browse/components/ImageThumbnail.tsx` (신규)
        - `apps/frontend/src/features/browse/utils/fileTypeUtils.ts` (신규)
        - `apps/frontend/src/features/browse/components/FolderContent/FolderContentGrid.tsx`
    - Commit: `6fade96` (feat: Grid 뷰에 이미지 썸네일 표시 기능 추가)
    - 결과: Grid 뷰에서 이미지 파일 미리보기 가능, 파일 식별성 향상.

- **이동/복사 모달 Space 트리 구조 개선 완료** (2026-02-11):
    - 문제: 이동/복사 모달의 FolderTree가 잘못된 방식으로 동작.
        - Space A에서 파일 선택 → 모달 열기 → Space A만 표시 (Space B, C로 이동 불가).
        - Space 미선택 시 시스템 디렉토리 노출 (보안/UX 문제).
    - 해결: FolderTree props 제거하여 모든 Space 목록 표시.
        - `rootPath`, `rootName`, `showBaseDirectories` props 제거 (3줄 삭제).
        - FolderTree가 자동으로 모든 Space 표시 (Zustand store 활용).
        - 메인 사이드바와 동일한 동작 방식.
    - 기술적 고려사항:
        - Space 경로 검증: 백엔드 `isPathAllowed`로 Space 외부 이동 차단.
        - 하위 폴더 순환 참조 방지: 프론트엔드에서 사전 체크.
        - Space 목록 동기화: Zustand store에서 자동으로 최신 목록 표시.
    - 수정 파일:
        - `apps/frontend/src/features/browse/components/DestinationPickerModal.tsx`
    - Commit: `85ddd94` (fix: 이동/복사 모달이 모든 Space 표시하도록 수정)
    - 결과: Space 간 파일 이동/복사 가능, 시스템 디렉토리 노출 방지, UX 개선.

- **Breadcrumb 및 모달 경로 표시 버그 수정 완료** (2026-02-11):
    - 문제 1: 하위 폴더 이동 시 Breadcrumb이 절대 경로로 표시됨.
        - 원인: `browseStore`의 `fetchDirectoryContents`가 `selectedSpace`를 업데이트하지 않음.
        - 해결: `fetchDirectoryContents`에서 현재 경로에 해당하는 Space를 자동으로 찾아서 설정.
        - `useSpaceStore`를 import하여 `spaces`에서 매칭되는 Space 탐색.
    - 문제 2: 이동/복사 모달 하단에 절대 경로 표시.
        - 해결: `DestinationPickerModal`에서 Space 정보를 받아서 상대 경로로 표시.
        - `selectedDestinationSpace` state 추가.
        - `handleSelect`에서 Space 정보도 함께 저장.
        - `displayPath` 계산 로직 추가 (Space 상대 경로).
    - 문제 3: 모달 하단 배경색이 다크모드에서 밝게 표시됨.
        - 해결: Ant Design 테마 토큰 사용 (`token.colorBgContainer`, `token.colorBorder`).
        - 하드코딩된 `#f0f0f0` 배경색 제거.
    - 수정 파일:
        - `apps/frontend/src/stores/browseStore.ts` (fetchDirectoryContents 수정)
        - `apps/frontend/src/features/browse/components/DestinationPickerModal.tsx` (Space 상대 경로, 다크모드 지원)
    - 결과:
        - Breadcrumb: "Root / Users / ... / Test Folder" → "헬로 / Test Folder" ✅
        - 모달 하단: "/Users/.../MyNewFolder" → "헬로/MyNewFolder" ✅
        - 다크모드 배경색 정상 작동 ✅

- **이동/복사 모달 폴더 선택 시 선택 해제 버그 수정 완료** (2026-02-13):
    - 문제: 파일/폴더를 선택한 상태에서 이동/복사 모달을 열고 모달 트리에서 폴더를 선택하면, 원래 선택된 항목이 해제되어 작업이 실패하거나 UX가 불안정함.
    - 원인: `FolderContent`의 컨테이너 `onClick` 핸들러(`handleContainerClick`)가 React Portal로 렌더링된 Modal 내부 클릭 이벤트까지 버블링으로 받아 `clearSelection()`을 실행.
    - 해결: `handleContainerClick`에서 `.ant-modal` 내부 클릭을 선택 해제 대상에서 제외.
    - 수정 파일:
        - `apps/frontend/src/features/browse/components/FolderContent.tsx`
    - 검증:
        - `pnpm -C apps/frontend lint` 통과.
        - `pnpm -C apps/frontend build` 통과.
        - 브라우저 수동 테스트: 이동 모달에서 폴더 선택 후 취소 시 `1개 선택됨` 상태 유지 확인.
        - 스크린샷: `.playwright-mcp/move-modal-selection-fixed.png`

## 다음 작업 (Next Steps)
- **FolderContent.tsx 리팩토링** (Phase 4: 검증 및 테스트).
- 검색 기능 구현.
- 이미지/텍스트 파일 미리보기 기능 구현.

- **이동/복사 모달 source selection 안정성 보강 완료** (2026-02-13):
    - 기존 모달이 실시간 `selectedItems`를 참조해 외부 상태 변화 시 source가 유실될 수 있는 구조를 개선.
    - `DestinationModalData.sources` 스냅샷 도입으로 모달 오픈 시점 source를 고정.
    - 모달 열림 중에는 네비게이션 변화가 있어도 `clearSelection()`을 건너뛰도록 처리.
    - 결과: 모달 폴더 선택/탐색 과정에서 source selection이 유지되고 이동/복사 동작 안정성 개선.
- **이동/복사 모달 취소 시 selection 복원 보강 완료** (2026-02-13):
    - 모달 취소/닫힘 타이밍에서 selection이 유실되는 케이스를 방지하기 위해 source snapshot 복원 로직 추가.
- **파일 작업 후 트리 자동 반영 구조 개선 완료** (2026-02-13):
    - `browseStore`에 `treeRefreshVersion`/`invalidateTree` 추가.
    - 파일 작업 성공 시 트리 invalidate 수행 (`rename`, `create-folder`, `delete`, `delete-multiple`, `move`, `copy`).
    - `FolderTree`가 invalidate 버전을 구독하여 로컬 트리 캐시를 초기화하고 최신 트리 재구성.
    - 브라우저 검증: `MyNewFolder/1234` 삭제 후 좌측 트리 재확장 시 노드 제거 반영 확인.
- **문서 위치 정리 완료** (2026-02-13):
    - 실행 환경 문서를 `docs/AGENTS.md`에서 루트 `AGENTS.md`로 이동.
    - `CLAUDE.md`, `GEMINI.md`가 루트 `AGENTS.md` 내용을 직접 포함하도록 동기화.
    - `master_rule_v2.md`의 시각 검증 규칙을 `chrome-extention` 기준으로 정리.
